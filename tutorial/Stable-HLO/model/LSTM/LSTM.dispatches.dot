digraph G {
  compound = true;
  subgraph cluster_1 {
    v2 [shape = plain, label = " "];
    label = "";
    v3 [shape = box, label = "arg0"];
    v4 [shape = box, label = "arg1"];
    v5 [shape = ellipse, label = "%0 = hal.tensor.import\ntensor<1x5xf32>"];
    v6 [shape = ellipse, label = "%1 = hal.tensor.import\ntensor<1x5x2x2xf32>"];
    v7 [shape = ellipse, label = "%2 = flow.tensor.reshape\ntensor<5x4xf32>"];
    v8 [shape = ellipse, label = "%3 = flow.tensor.splat\ntensor<5x64xf32>"];
    v9 [shape = box, label = "%4 = flow.dispatch[]\n@main_dispatch_0::@main_dispatch_0_slow_memcpy(%2, %3)\n%0 = flow.dispatch.tensor.load %arg0 -> tensor<5x4xf32>\lflow.dispatch.tensor.store %0, %arg1\ltensor<5x64xf32>"];
    v10 [shape = ellipse, label = "%5 = flow.tensor.reshape\ntensor<5x1x64xf32>"];
    v11 [shape = ellipse, label = "%6 = flow.tensor.reshape\ntensor<5xf32>"];
    v12 [shape = ellipse, label = "%7 = flow.tensor.reshape\ntensor<5x1x1xf32>"];
    v13 [shape = box, label = "%8 = flow.dispatch[]\n@main_dispatch_1::@main_dispatch_1_generic_5_f32xi32xi32(%6)\n%0 = flow.dispatch.tensor.load %arg0 -> tensor<5xf32>\l%1 = tensor.empty() : tensor<i32>\l%2 = linalg.fill ins(%c-2147483648_i32 : i32) outs(%1 : tensor<i32>) -> tensor<i32>\l%3 = linalg.generic[reduction] (%0, %cst_0) -> (%2)\l        %4 = arith.cmpf oeq, %in, %cst : f32\l        %5 = arith.extui %4 : i1 to i32\l        %6 = arith.muli %5, %in_1 : i32\l        %7 = arith.maxsi %out, %6 : i32\l        linalg.yield %7 : i32\lflow.dispatch.tensor.store %3, %arg1\ltensor<i32>"];
    v14 [shape = box, label = "%9 = flow.dispatch[]\n@main_dispatch_2::@main_dispatch_2_generic_5_i32(%6)\n%0 = flow.dispatch.tensor.load %arg0 -> tensor<5xf32>\l%1 = tensor.empty() : tensor<i32>\l%2 = linalg.fill ins(%c-2147483648_i32 : i32) outs(%1 : tensor<i32>) -> tensor<i32>\l%3 = linalg.generic[reduction] (%cst_0) -> (%2)\l        %4 = linalg.index 0 : index\l        %5 = arith.subi %c4, %4 : index\l        %extracted = tensor.extract %0[%5] : tensor<5xf32>\l        %6 = arith.cmpf oeq, %extracted, %cst : f32\l        %7 = arith.extui %6 : i1 to i32\l        %8 = arith.muli %7, %in : i32\l        %9 = arith.maxsi %out, %8 : i32\l        linalg.yield %9 : i32\lflow.dispatch.tensor.store %3, %arg1\ltensor<i32>"];
    v15 [shape = box, label = "%10#0%10#1 = flow.dispatch[]\n@main_dispatch_3::@main_dispatch_3_elementwise(%8, %9)\n%0 = flow.dispatch.tensor.load %arg0 -> tensor<i32>\l%1 = flow.dispatch.tensor.load %arg1 -> tensor<i32>\l%2 = tensor.empty() : tensor<i64>\l%3#0%3#1 = linalg.generic[] (%0, %1) -> (%2, %2)\l        %4 = arith.subi %c5_i32, %in : i32\l        %5 = arith.subi %c5_i32, %in_0 : i32\l        %6 = arith.cmpi eq, %4, %c5_i32 : i32\l        %7 = arith.select %6, %c0_i32, %5 : i32\l        %8 = arith.extsi %7 : i32 to i64\l        %9 = arith.extsi %in : i32 to i64\l        linalg.yield %8, %9 : i64, i64\lflow.dispatch.tensor.store %3#0, %arg2\lflow.dispatch.tensor.store %3#1, %arg3\ltensor<i64>\ntensor<i64>"];
    v16 [shape = ellipse, label = " = cf.br\n"];
  }
  subgraph cluster_17 {
    v18 [shape = plain, label = " "];
    label = "";
    v19 [shape = box, label = "arg0"];
    v20 [shape = box, label = "arg1"];
    v21 [shape = box, label = "arg2"];
    v22 [shape = box, label = "arg3"];
    v23 [shape = box, label = "arg4"];
    v24 [shape = box, label = "arg5"];
    v25 [shape = box, label = "arg6"];
    v26 [shape = box, label = "arg7"];
    v27 [shape = box, label = "arg8"];
    v28 [shape = box, label = "%20 = flow.dispatch[]\n@main_dispatch_4::@main_dispatch_4_elementwise(%11, %12)\n%0 = flow.dispatch.tensor.load %arg0 -> tensor<i64>\l%1 = flow.dispatch.tensor.load %arg1 -> tensor<i64>\l%2 = tensor.empty() : tensor<i1>\l%3 = linalg.generic[] (%0, %1) -> (%2)\l        %4 = arith.cmpi slt, %in, %in_0 : i64\l        linalg.yield %4 : i1\lflow.dispatch.tensor.store %3, %arg2\ltensor<i1>"];
    v29 [shape = ellipse, label = "%21 = flow.tensor.load\ni1"];
    v30 [shape = ellipse, label = " = cf.cond_br\n"];
  }
  subgraph cluster_31 {
    v32 [shape = plain, label = " "];
    label = "";
    v33 [shape = box, label = "%22#0%22#1 = flow.dispatch[]\n@main_dispatch_5::@main_dispatch_5_elementwise(%11, %18)\n%0 = flow.dispatch.tensor.load %arg0 -> tensor<i64>\l%1 = flow.dispatch.tensor.load %arg1 -> tensor<5x1x1xf32>\l%2 = tensor.empty() : tensor<f32>\l%3 = tensor.empty() : tensor<i64>\l%4 = linalg.generic[] (%0) -> (%3)\l        %6 = arith.addi %in, %c1_i64 : i64\l        linalg.yield %6 : i64\l%5 = linalg.generic[] (%0) -> (%2)\l        %6 = arith.index_cast %in : i64 to index\l        %extracted = tensor.extract %1[%6, %c0, %c0] : tensor<5x1x1xf32>\l        linalg.yield %extracted : f32\lflow.dispatch.tensor.store %5, %arg2\lflow.dispatch.tensor.store %4, %arg3\ltensor<f32>\ntensor<i64>"];
    v34 [shape = box, label = "%23 = flow.dispatch[]\n@main_dispatch_6::@main_dispatch_6_elementwise_broadcast_64_i64xf32(%17, %11)\n%0 = flow.dispatch.tensor.load %arg0 -> tensor<5x1x64xf32>\l%1 = flow.dispatch.tensor.load %arg1 -> tensor<i64>\l%2 = tensor.empty() : tensor<64xf32>\l%3 = linalg.generic[parallel] (%1) -> (%2)\l        %4 = arith.index_cast %in : i64 to index\l        %5 = linalg.index 0 : index\l        %extracted = tensor.extract %0[%4, %c0, %5] : tensor<5x1x64xf32>\l        linalg.yield %extracted : f32\lflow.dispatch.tensor.store %3, %arg2\ltensor<64xf32>"];
    v35 [shape = ellipse, label = "%24 = flow.tensor.empty\ntensor<1x74xf32>"];
    v36 [shape = ellipse, label = "%25 = flow.tensor.reshape\ntensor<1x64xf32>"];
    v37 [shape = ellipse, label = "%26 = flow.tensor.update\ntensor<1x74xf32>"];
    v38 [shape = ellipse, label = "%27 = flow.tensor.update\ntensor<1x74xf32>"];
    v39 [shape = ellipse, label = "%28 = flow.tensor.reshape\ntensor<74xf32>"];
    v40 [shape = box, label = "%29 = flow.dispatch[]\n@main_dispatch_7::@main_dispatch_7_vecmat_40x74_f32(%28, %14, %13)\n%0 = flow.dispatch.tensor.load %arg0 -> tensor<74xf32>\l%1 = flow.dispatch.tensor.load %arg1 -> tensor<74x40xf32>\l%2 = flow.dispatch.tensor.load %arg2 -> tensor<40xf32>\l%3 = tensor.empty() : tensor<40xf32>\l%4 = linalg.fill ins(%cst : f32) outs(%3 : tensor<40xf32>) -> tensor<40xf32>\l%5 = linalg.vecmat ins(%0, %1 : tensor<74xf32>, tensor<74x40xf32>) outs(%4 : tensor<40xf32>) -> tensor<40xf32>\l%6 = linalg.generic[parallel] (%5, %2) -> (%3)\l        %7 = arith.addf %in, %in_0 : f32\l        linalg.yield %7 : f32\lflow.dispatch.tensor.store %6, %arg3\ltensor<40xf32>"];
    v41 [shape = ellipse, label = "%30 = flow.tensor.reshape\ntensor<1x40xf32>"];
    v42 [shape = ellipse, label = "%31 = flow.tensor.slice\ntensor<1x10xf32>"];
    v43 [shape = ellipse, label = "%32 = flow.tensor.slice\ntensor<1x10xf32>"];
    v44 [shape = ellipse, label = "%33 = flow.tensor.slice\ntensor<1x10xf32>"];
    v45 [shape = ellipse, label = "%34 = flow.tensor.slice\ntensor<1x10xf32>"];
    v46 [shape = box, label = "%35#0%35#1 = flow.dispatch[]\n@main_dispatch_8::@main_dispatch_8_elementwise_1x10_f32(%22#0, %16, %34, %15, %31, %32, %33)\n%0 = flow.dispatch.tensor.load %arg0 -> tensor<f32>\l%1 = flow.dispatch.tensor.load %arg1 -> tensor<1x10xf32>\l%2 = flow.dispatch.tensor.load %arg2 -> tensor<1x10xf32>\l%3 = flow.dispatch.tensor.load %arg3 -> tensor<1x10xf32>\l%4 = flow.dispatch.tensor.load %arg4 -> tensor<1x10xf32>\l%5 = flow.dispatch.tensor.load %arg5 -> tensor<1x10xf32>\l%6 = flow.dispatch.tensor.load %arg6 -> tensor<1x10xf32>\l%7 = tensor.empty() : tensor<1x10xf32>\l%8#0%8#1 = linalg.generic[parallel, parallel] (%0, %1, %2, %3, %4, %5, %6) -> (%7, %7)\l        %9 = arith.mulf %in_6, %cst : f32\l        %10 = math.tanh %9 : f32\l        %11 = arith.mulf %10, %cst : f32\l        %12 = arith.addf %11, %cst : f32\l        %13 = arith.mulf %in_7, %cst : f32\l        %14 = math.tanh %in_8 : f32\l        %15 = math.tanh %13 : f32\l        %16 = arith.mulf %15, %cst : f32\l        %17 = arith.addf %16, %cst : f32\l        %18 = arith.mulf %17, %14 : f32\l        %19 = arith.mulf %12, %in_5 : f32\l        %20 = arith.addf %19, %18 : f32\l        %21 = arith.minimumf %20, %cst_0 : f32\l        %22 = arith.maximumf %21, %cst_1 : f32\l        %23 = arith.cmpf ogt, %in, %cst_2 : f32\l        %24 = arith.select %23, %in_5, %22 : f32\l        %25 = arith.mulf %in_4, %cst : f32\l        %26 = math.tanh %25 : f32\l        %27 = math.tanh %22 : f32\l        %28 = arith.mulf %26, %cst : f32\l        %29 = arith.addf %28, %cst : f32\l        %30 = arith.mulf %29, %27 : f32\l        %31 = arith.select %23, %in_3, %30 : f32\l        linalg.yield %24, %31 : f32, f32\lflow.dispatch.tensor.store %8#0, %arg7\lflow.dispatch.tensor.store %8#1, %arg8\ltensor<1x10xf32>\ntensor<1x10xf32>"];
    v47 [shape = ellipse, label = "%36 = flow.tensor.reshape\ntensor<10xf32>"];
    v48 [shape = box, label = "%37 = flow.dispatch[]\n@main_dispatch_9::@main_dispatch_9_elementwise(%11)\n%0 = flow.dispatch.tensor.load %arg0 -> tensor<i64>\l%1 = tensor.empty() : tensor<i32>\l%2 = linalg.generic[] (%0) -> (%1)\l        %3 = arith.trunci %in : i64 to i32\l        linalg.yield %3 : i32\lflow.dispatch.tensor.store %2, %arg1\ltensor<i32>"];
    v49 [shape = ellipse, label = "%38 = flow.tensor.load\ni32"];
    v50 [shape = ellipse, label = "%39 = arith.index_cast\nindex"];
    v51 [shape = ellipse, label = "%40 = arith.maxsi\nindex"];
    v52 [shape = ellipse, label = "%41 = arith.minsi\nindex"];
    v53 [shape = box, label = "%42 = flow.dispatch[%41]\n@main_dispatch_10::@main_dispatch_10_slow_memcpy(%36, %19, %41)\n%0 = flow.dispatch.workload.ordinal %arg2, 0 : index\l%1 = flow.dispatch.tensor.load %arg0 -> tensor<10xf32>\lflow.dispatch.tensor.store %1, %arg1\ltensor<5x1x10xf32>"];
    v54 [shape = ellipse, label = " = cf.br\n"];
  }
  subgraph cluster_55 {
    v56 [shape = plain, label = " "];
    label = "";
    v57 [shape = ellipse, label = "%43 = hal.tensor.export\n!hal.buffer_view"];
    v58 [shape = ellipse, label = " = util.return\n"];
  }
  v3 -> v5 [style = solid, label = ""];
  v4 -> v6 [style = solid, label = ""];
  v6 -> v7 [style = solid, label = ""];
  v7 -> v9 [style = solid, label = "0"];
  v8 -> v9 [style = solid, label = "1"];
  v9 -> v10 [style = solid, label = ""];
  v5 -> v11 [style = solid, label = ""];
  v5 -> v12 [style = solid, label = ""];
  v11 -> v13 [style = solid, label = ""];
  v11 -> v14 [style = solid, label = ""];
  v13 -> v15 [style = solid, label = "0"];
  v14 -> v15 [style = solid, label = "1"];
  v15 -> v16 [style = solid, label = "0"];
  v15 -> v16 [style = solid, label = "1"];
  v10 -> v16 [style = solid, label = "6"];
  v12 -> v16 [style = solid, label = "7"];
  v19 -> v28 [style = solid, label = "0"];
  v20 -> v28 [style = solid, label = "1"];
  v28 -> v29 [style = solid, label = ""];
  v29 -> v30 [style = solid, label = ""];
  v19 -> v33 [style = solid, label = "0"];
  v26 -> v33 [style = solid, label = "1"];
  v25 -> v34 [style = solid, label = "0"];
  v19 -> v34 [style = solid, label = "1"];
  v34 -> v36 [style = solid, label = ""];
  v35 -> v37 [style = solid, label = "0"];
  v36 -> v37 [style = solid, label = "3"];
  v37 -> v38 [style = solid, label = "0"];
  v24 -> v38 [style = solid, label = "3"];
  v38 -> v39 [style = solid, label = ""];
  v39 -> v40 [style = solid, label = "0"];
  v22 -> v40 [style = solid, label = "1"];
  v21 -> v40 [style = solid, label = "2"];
  v40 -> v41 [style = solid, label = ""];
  v41 -> v42 [style = solid, label = "0"];
  v41 -> v43 [style = solid, label = "0"];
  v41 -> v44 [style = solid, label = "0"];
  v41 -> v45 [style = solid, label = "0"];
  v33 -> v46 [style = solid, label = "0"];
  v24 -> v46 [style = solid, label = "1"];
  v45 -> v46 [style = solid, label = "2"];
  v23 -> v46 [style = solid, label = "3"];
  v42 -> v46 [style = solid, label = "4"];
  v43 -> v46 [style = solid, label = "5"];
  v44 -> v46 [style = solid, label = "6"];
  v46 -> v47 [style = solid, label = ""];
  v19 -> v48 [style = solid, label = ""];
  v48 -> v49 [style = solid, label = ""];
  v49 -> v50 [style = solid, label = ""];
  v50 -> v51 [style = solid, label = "0"];
  v51 -> v52 [style = solid, label = "0"];
  v52 -> v53 [style = solid, label = "0"];
  v47 -> v53 [style = solid, label = "1"];
  v27 -> v53 [style = solid, label = "2"];
  v52 -> v53 [style = solid, label = "3"];
  v33 -> v54 [style = solid, label = "0"];
  v20 -> v54 [style = solid, label = "1"];
  v21 -> v54 [style = solid, label = "2"];
  v22 -> v54 [style = solid, label = "3"];
  v46 -> v54 [style = solid, label = "4"];
  v46 -> v54 [style = solid, label = "5"];
  v25 -> v54 [style = solid, label = "6"];
  v26 -> v54 [style = solid, label = "7"];
  v53 -> v54 [style = solid, label = "8"];
  v27 -> v57 [style = solid, label = ""];
  v57 -> v58 [style = solid, label = ""];
}
